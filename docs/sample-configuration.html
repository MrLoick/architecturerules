<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="Assert Your Architecture - with this open source java library. Leverages XML and optional programatic configuration to assert your code's architecture via unit tests or ant tasks. Able to check for layer independence and cyclic dependencies." />
<meta name="keywords" content="open source java xml jdepend architecture rules unit test junit" />
<title>architecture rules</title>
<link rel="stylesheet" type="text/css" href="css/style.css" />
<link rel="stylesheet" type="text/css" href="css/nifty.css" />
<link rel="stylesheet" type="text/css" href="css/syntax.css"  />
<!--[if lt IE 8]>
<style type="text/css">
  #mainmenu li a, #recentposts li a, #personalfavorites li a, #textads li a, #recentcomments li, #contactme li {display:inline-block;}
  #mainmenu li a, #recentposts li a, #personalfavorites li a, #textads li a, #recentcomments li, #contactme li {display:block;}
  *html #page {width:expression(document.documentElement.clientWidth > 1010? "1010px" : auto")}
</style>
<![endif]-->
</head>
<body>
<div id="page">
  <div id="blogtitle" class="primary"><a href="http://architecturerules.googlecode.com/svn/docs/index.html">architecture</a><span>rules</span></div>
  <div id="backtogoogle"><a href="http://code.google.com/p/architecturerules/">google code landing page</a></div>
  <div id="about">
    <p class="description"> <strong>Assert Your Architecture!</strong> with this <em>open source</em> <strong>java</strong> library. Architecture Rules leverages an <a href="sample-configuration.html">xml configuration file</a> and optional programatic configuration to assert your code's architecture via <a href="getting-started.html">unit tests</a> or <a href="ant-task.html">ant tasks</a>. This test is able to assert that specific packages do not depend on others and is able to check for and report on cyclic dependencies among your project's packages and classes. This project wraps a industry accepted <a href="http://clarkware.com/software/JDepend.html" target="_jdepend">JDepend</a> to simplify the process of maintaining a solid software architecture.</p>
    <ul id="mainmenu">
      <li id="home" class="page_item current_page_item"><a title="home" href="index.html" accesskey="h"><span>H</span>ome</a></li>
      <li id="source" class="page_item"><a href="source.html"><span>S</span>ource</a></li>
      <li id="source" class="page_item"><a href="downloads.html"><span>D</span>ownloads</a></li>
    </ul>
  </div>
  <!-- /about -->
  <div id="primary" class="single hfeed">
    <div class="hentry post programming" id="">
      <h1 class="posttitle entry-title">Sample Configuration</h1>
      <p class="postmetadata">XML</p>
      <div class="entry entry-content">
        <p> The simplest and most effective way to setup your rules, is to create <tt>architecture-rules.xml</tt> in a directory such as <tt>/src/main/resources</tt>, or any other directory that will end up in the project's classpath. Once the file is created, add your configuration and rules such as in this example below. </p>
        <h4>architecture-rules.xml</h4>
        <pre name="code" class="xml:nocontrols:nogutter">
		<?xml version="1.0"?>
		
		<architecture>
		
			<configuration>	
				<sources no-packages="ignore">
					<source not-found="ignore">core\target\classes</source>
					<source not-found="ignore">web\target\classes</source>
					<source not-found="ignore">web-ws\target\classes</source>				
				</sources>
				<cyclicalDependency test="true"></cyclicalDependency>
			</configuration>
				
			<rules>
		
				<rule id="dao">	
					<comment>dao layer depends on no other layers</comment>		
					<packages>
						<package>com.company.app.core.dao</package>
						<package>com.company.app.core.dao.hibernate</package>
					</packages>		
					<violations>
						<violation>com.company.app.core.services</violation>
						<violation>com.company.app.web</violation>
						<violation>com.company.app.web.spring</violation>
					</violations>
				</rule>
		
				<rule id="presentation">		
					<comment>presentation layer may not use dao directly</comment>		
					<packages>
						<package>com.company.app.web</package>
						<package>com.company.app.web.spring</package>
						<package>com.company.app.web.decorators</package>
					</packages>		
					<violations>
						<violation>com.company.app.core.dao</violation>
						<violation>com.company.app.core.dao.hibernate</violation>
						<violation>com.company.app.core.dao.jdap</violation>
						<violation>com.company.app.core.dao.jdbc</violation>
					</violations>
				</rule>
		
			</rules>
		
		</architecture>		
		</pre>
      </div>
      <!-- entry -->
    </div>
    <!-- post -->
    <div class="hentry post programming" id="">
      <h1 class="posttitle entry-title">Sample Configuration Breakdown</h1>
      <p class="postmetadata">XML</p>
      <div class="entry entry-content">
        <p>Here is an explaination of the various xml nodes.</p>
        <h3>Sources</h3>
        <pre name="code" class="xml:nocontrols:nogutter">			
		<sources no-packages="ignore">
			<source not-found="ignore">core\target\classes</source>
			<source not-found="ignore">web\target\classes</source>
			<source not-found="ignore">web-ws\target\classes</source>
		</sources>
		</pre>
        <p> Sources are the directories that JDepend will analyze. The Jdepend docs call these sources, but in reality you want to point to your complied classes. </p>
        <tt>&lt;sources no-packages="ignore"&gt;</tt>
        <p>Valid no-packages values are ignore and exception.</p>
        <ul>
          <li><tt>ignore</tt> will continue on when the source directory does not exist</li>
          <li><tt>exception</tt> will throw a <a href="exceptions.html#SourceNotFoundException">SourceNotFoundException</a> when the directory does not exit</li>
        </ul>
        <tt>&lt;source not-found="ignore"&gt;core/target/classes&lt;/source&gt;</tt>
        <p>Sources can be a relative path or an absolute path. Valid not-found values are ignore and exception.</p>
        <ul>
          <li><tt>ignore</tt> will continue when no packages exist, but nothing will be tested. Not recommended.</li>
          <li><tt>exception</tt> will throw a <a href="exceptions.html#NoPackagesFoundException">NoPackagesFoundException</a>: No packages found when no packages are found in any of the given sources.</li>
        </ul>
        <h3>Cyclic Dependency Test</h3>
        <pre name="code" class="xml:nocontrols:nogutter">	
<cyclicalDependency test="true"></cyclicalDependency>
</pre>
        <p> Easy as true or false to indicate weather you want this test to run or not. When this test runs and fails, a <a href="exceptions.html#CyclicRedundencyException">CyclicRedundencyException</a> is thrown. </p>
        <h3>Rules</h3>
        <p> Rules define a package, and then go on to list each package that would be considered a violation to depend on. An id is used to refer to the rule when something goes wrong, and a comment may be entered in order to document the rule for future developers (or even for yourself for that matter.) </p>
        <pre name="code" class="xml:nocontrols:nogutter">	
	<rule id="dao">   
		<comment>dao layer depends on no other layers</comment>       
		<packages>  
			<package>com.company.app.core.dao</package>  
			<package>com.company.app.core.dao.hibernate</package>  
		</packages>       
		<violations>  
			<violation>com.company.app.core.services</violation>  
			<violation>com.company.app.web</violation>  
			<violation>com.company.app.web.spring</violation>  
		</violations>  
	</rule>  
	</pre>
        <p> ids can not be duplicated, but packages can. If you want to break up violations for the same package you can do that.</p>
        <p> You can add more than one package to a rule. For example <tt>..dao</tt> and <tt>..dao.hibernate</tt> packages are probably going to be the same, so you can define them in a single rule. This is a change from the version 1 releases</p>
        <p> You can not add a violation that is identical to the package. This is because, in reality, if you have a class that uses a class in the same package, no imports are defined, and therefor this situation can not be tested. If you try this, you will get an <a href="exceptions.html#IllegalRuleException">IllegalRuleException</a> </p>
      </div>
    </div>
    <div class="hentry post programming" id="">
      <h1 class="posttitle entry-title">Sample Configuration</h1>
      <p class="postmetadata">Programatic</p>
      <div class="entry entry-content">
        <p>You also have the option of programatic configuration when running architecture-rules as a unit test - you don't have this option when running via the <a href="ant-task.html">ant-task</a>. Assuming you followed the <a href="getting-started.html">getting started</a> tutorial, you now have a unit test that extends <tt>AbstractArchitectureRulesConfigurationTest</tt>. From here, you can simply call <tt>getConfiguration()</tt> which will return the Configuration entity that has been populated with the settings from <tt>architecture-rules.xml</tt>. With this Configuration reference, you may not create new <tt>Rule</tt> and <tt>SourceDirectory</tt> entities and add them to the configuration.</p>
        <h3>Example</h3>
        <pre name="code" class="java:nocontrols:nogutter">
	  
/**
 * Get the configuration that already has the architecture-rules.xml
 * configuration loaded.
 */
final Configuration configuration = getConfiguration();

final Rule rule = new Rule("services");
rule.setComment("services may not depend on web layer.");
rule.addPackage("com.company.app.core.services");
rule.addViolation("com.company.app.web");
rule.addViolation("com.company.app.web.spring");
rule.addViolation("com.company.app.web.decorators");

configuration.addRule(rule);

/**
 * Changing a boolean like 
 * configuration.setDoCyclicDependencyTest(false) would override 
 * the value in the configuration file, because the configuration 
 * file is loaded first.
 */
configuration.setDoCyclicDependencyTest(false);		
	  </pre>
        <p>In this example, the configuration is pre-populated with the configuration found in the XML file with the name returned by the method <tt>String getConfigurationFileName()</tt> in your unit test. If you do not implement this method, or of you return <tt>""</tt> then the configuraiton will be empty.</p>
      </div>
    </div>
  </div>
  <div id="secondary">
    <h4>mailing<span>lists</span></h4>
    <ul id="mailinglists">
      <li> <a href="http://groups.google.com/group/architecture-rules-users/topics?gvc=2" >architecture-rules-user</a> <a href="http://groups.google.com/group/architecture-rules-users/feed/rss_v2_0_topics.xml" class="rss"> rss </a> </li>
      <li> <a href="http://groups.google.com/group/architecture-rules-dev/topics?gvc=2">architecture-rules-dev</a> <a href="http://groups.google.com/group/architecture-rules-dev/feed/rss_v2_0_topics.xml" class="rss"> rss </a> </li>
      <li> <a href="http://groups.google.com/group/architecture-rules-activity/topics?gvc=2">architecture-rules-activity</a> <a href="http://groups.google.com/group/architecture-rules-activity/feed/rss_v2_0_topics.xml" class="rss"> rss </a> </li>
    </ul>
    <h4>issue<span>list</span></h4>
    <ul id="issues">
      <li class="alignleft"><a href="http://code.google.com/p/architecturerules/issues/list">view issues</a></li>
      <li class="alignright"><a href="http://code.google.com/p/architecturerules/issues/entry">report issue</a></li>
    </ul>
    <h4>more<span>information</span></h4>
    <p>Just a little something something for the people.</p>
    <ul id="moreinformation">
      <li><a href="getting-started.html">Getting Started</a> configuration examples and how to run the test</li>
      <li><a href="sample-configuration.html">Sample Configuration</a> to get you started</li>
      <li><a href="ant-task.html">Ant Task</a> to run from ant rather than JUnit</li>
      <li><a href="exceptions.html">Exceptions</a> descriptions of all them</li>
      <li><a href="alternatives.html">Alternative</a> architecture monitoring java solutions</li>
    </ul>
    <h4>licence<span>details</span></h4>
    <p>Licenced under <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a> - <small>allows use of the source code for the development of free and open source software as well as proprietary and closed source software.</small></p>
  </div>
</div>
<!-- footer -->
<div style="clear: both;"></div>
<div id="footbar">
  <p>need some content?</p>
</div>
<!-- /footer -->
<!-- syntaxhighlighter -->
<script type="text/javascript" src="http://syntaxhighlighter.googlecode.com/svn/tags/1.5.1/Scripts/shCore.js" language="JavaScript">
</script>
<script type="text/javascript" src="http://syntaxhighlighter.googlecode.com/svn/tags/1.5.1/Scripts/shBrushXml.js" language="JavaScript">
</script>
<script type="text/javascript" src="http://syntaxhighlighter.googlecode.com/svn/tags/1.5.1/Scripts/shBrushJava.js" language="JavaScript">
</script>
<!-- nifty -->
<script type="text/javascript" src="js/nifty.js" language="JavaScript">
</script>
<script language="javascript">	
	window.onload = function () {
    	dp.SyntaxHighlighter.ClipboardSwf = 'http://syntaxhighlighter.googlecode.com/svn/tags/1.5.1/Scripts/clipboard.swf';
	    dp.SyntaxHighlighter.HighlightAll('code');
	
		if(!NiftyCheck())
            return;

		Rounded("div#about","#fff","#E7EFFF");
		Rounded("div#downloadnow","#fff","#e8fecd");
		RoundedTop("div#footbar","#fff","#e8fecd");
	}
</script>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-616623-3";
urchinTracker();
</script>
</div>
</body>
</html>
